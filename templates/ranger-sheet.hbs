<form class="{{cssClass}} flexcol wastelands-sheet ranger-sheet" autocomplete="off">
  {{!-- Header --}}
  <header class="sheet-header">
    <img class="profile-img" src="{{actor.img}}" data-edit="img" title="{{actor.name}}"/>
    <div class="header-fields">
      <h1 class="charname"><input name="name" type="text" value="{{actor.name}}" placeholder="Ranger Name"/></h1>
      <div class="resources grid grid-4col">
        <div class="resource flex-group-center">
          <label for="system.attributes.health.value" class="resource-label">Health</label>
          <div class="resource-content flexrow flex-center flex-between">
            <input type="text" name="system.attributes.health.value" value="{{system.attributes.health.value}}" data-dtype="Number"/>
            <span> / </span>
            <input type="text" name="system.attributes.health.max" value="{{system.attributes.health.max}}" data-dtype="Number"/>
          </div>
        </div>
        
        <div class="resource flex-group-center">
          <label for="system.attributes.actionPoints.value" class="resource-label">Action Points</label>
          <div class="resource-content flexrow flex-center flex-between">
            <input type="text" name="system.attributes.actionPoints.value" value="{{system.attributes.actionPoints.value}}" data-dtype="Number"/>
            <span> / </span>
            <input type="text" name="system.attributes.actionPoints.max" value="{{system.attributes.actionPoints.max}}" data-dtype="Number"/>
          </div>
        </div>
        
        <div class="resource flex-group-center">
          <label for="system.attributes.level" class="resource-label">Level</label>
          <div class="resource-content">
            <input type="text" name="system.attributes.level" value="{{system.attributes.level}}" data-dtype="Number"/>
          </div>
        </div>

        <div class="resource flex-group-center">
          <label for="system.attributes.skillPoints" class="resource-label">Skill Points</label>
          <div class="resource-content">
            <input type="text" name="system.attributes.skillPoints" value="{{system.attributes.skillPoints}}" data-dtype="Number"/>
          </div>
        </div>
      </div>
    </div>
  </header>

  {{!-- Navigation Tabs --}}
  <nav class="sheet-tabs tabs" data-group="primary">
    <a class="item" data-tab="attributes">Attributes</a>
    <a class="item" data-tab="skills">Skills</a>
    <a class="item" data-tab="combat">Combat</a>
    <a class="item" data-tab="inventory">Inventory</a>
    <a class="item" data-tab="background">Background</a>
  </nav>

  {{!-- Sheet Body --}}
  <section class="sheet-body">
    <!-- Attributes Tab -->
    <div class="tab attributes" data-group="primary" data-tab="attributes">
      <!-- Simple Health -->
      <div class="resource">
          <label>Health:</label>
          <input type="number" name="system.attributes.health.value" value="{{system.attributes.health.value}}"/>
          <span>/</span>
          <input type="number" name="system.attributes.health.max" value="{{system.attributes.health.max}}"/>
      </div>

      <!-- Simple Action Points -->
      <div class="resource">
          <label>Action Points:</label>
          <input type="number" name="system.attributes.actionPoints.value" value="{{system.attributes.actionPoints.value}}"/>
          <span>/</span>
          <input type="number" name="system.attributes.actionPoints.max" value="{{system.attributes.actionPoints.max}}"/>
      </div>

      <!-- Simple Core Attributes -->
      <h3>Core Attributes</h3>
      
      <!-- Coordination -->
      <div class="attribute-simple">
          <label>Coordination:</label>
          <input type="number" name="system.attributes.stats.coordination.value" value="{{system.attributes.stats.coordination.value}}" min="1" max="10"/>
          <span>Max: {{system.attributes.stats.coordination.max}}</span>
      </div>

      <!-- Intelligence -->
      <div class="attribute-simple">
          <label>Intelligence:</label>
          <input type="number" name="system.attributes.stats.intelligence.value" value="{{system.attributes.stats.intelligence.value}}" min="1" max="10"/>
          <span>Max: {{system.attributes.stats.intelligence.max}}</span>
      </div>

      <!-- Strength -->
      <div class="attribute-simple">
          <label>Strength:</label>
          <input type="number" name="system.attributes.stats.strength.value" value="{{system.attributes.stats.strength.value}}" min="1" max="10"/>
          <span>Max: {{system.attributes.stats.strength.max}}</span>
      </div>

      <!-- Luck -->
      <div class="attribute-simple">
          <label>Luck:</label>
          <input type="number" name="system.attributes.stats.luck.value" value="{{system.attributes.stats.luck.value}}" min="1" max="10"/>
          <span>Max: {{system.attributes.stats.luck.max}}</span>
      </div>

      <!-- Awareness -->
      <div class="attribute-simple">
          <label>Awareness:</label>
          <input type="number" name="system.attributes.stats.awareness.value" value="{{system.attributes.stats.awareness.value}}" min="1" max="10"/>
          <span>Max: {{system.attributes.stats.awareness.max}}</span>
      </div>

      <!-- Speed -->
      <div class="attribute-simple">
          <label>Speed:</label>
          <input type="number" name="system.attributes.stats.speed.value" value="{{system.attributes.stats.speed.value}}" min="1" max="10"/>
          <span>Max: {{system.attributes.stats.speed.max}}</span>
      </div>

      <!-- Charisma -->
      <div class="attribute-simple">
          <label>Charisma:</label>
          <input type="number" name="system.attributes.stats.charisma.value" value="{{system.attributes.stats.charisma.value}}" min="1" max="10"/>
          <span>Max: {{system.attributes.stats.charisma.max}}</span>
      </div>

      {{!-- Derived Stats --}}
      <div class="derived-stats grid grid-3col">
        <div class="derived-stat flex-group-center">
          <label>Strike Rate</label>
          <span>{{system.attributes.derived.strikeRate}}%</span>
        </div>
        <div class="derived-stat flex-group-center">
          <label>Critical Chance</label>
          <span>{{system.attributes.derived.criticalChance}}%</span>
        </div>
        <div class="derived-stat flex-group-center">
          <label>Carry Weight</label>
          <span>{{system.attributes.derived.maxCarryWeight}} kg</span>
        </div>
      </div>
    </div>

    <!-- Skills Tab -->
    <div class="tab skills" data-group="primary" data-tab="skills">
      <h2>Skills</h2>

      <div class="skills-grid">
        <!-- Weapons Skills -->
        <div class="skill-category">
          <h3>Weapons</h3>
          <div class="skills-list grid grid-2col">
            {{#each system.skills.weapons as |skill skillName|}}
            <div class="skill-item flexrow">
              <label class="skill-name">{{skillName}}</label>
              <input type="number" name="system.skills.weapons.{{skillName}}.value" value="{{skill.value}}" min="0" max="10" class="skill-value"/>
              <span class="skill-attribute">({{skill.attribute}})</span>
              <button type="button" class="skill-roll" data-skill="{{skillName}}" data-category="weapons">
                <i class="fas fa-dice-d20"></i>
              </button>
            </div>
            {{/each}}
          </div>
        </div>

        <!-- Combat Skills -->
        <div class="skill-category">
          <h3>Combat</h3>
          <div class="skills-list grid grid-2col">
            {{#each system.skills.combat as |skill skillName|}}
            <div class="skill-item flexrow">
              <label class="skill-name">{{skillName}}</label>
              <input type="number" name="system.skills.combat.{{skillName}}.value" value="{{skill.value}}" min="0" max="10" class="skill-value"/>
              <span class="skill-attribute">({{skill.attribute}})</span>
              <button type="button" class="skill-roll" data-skill="{{skillName}}" data-category="combat">
                <i class="fas fa-dice-d20"></i>
              </button>
            </div>
            {{/each}}
          </div>
        </div>

        <!-- Survival Skills -->
        <div class="skill-category">
          <h3>Survival</h3>
          <div class="skills-list grid grid-2col">
            {{#each system.skills.survival as |skill skillName|}}
            <div class="skill-item flexrow">
              <label class="skill-name">{{skillName}}</label>
              <input type="number" name="system.skills.survival.{{skillName}}.value" value="{{skill.value}}" min="0" max="10" class="skill-value"/>
              <span class="skill-attribute">({{skill.attribute}})</span>
              <button type="button" class="skill-roll" data-skill="{{skillName}}" data-category="survival">
                <i class="fas fa-dice-d20"></i>
              </button>
            </div>
            {{/each}}
          </div>
        </div>

        <!-- Tech Skills -->
        <div class="skill-category">
          <h3>Tech</h3>
          <div class="skills-list grid grid-2col">
            {{#each system.skills.tech as |skill skillName|}}
            <div class="skill-item flexrow">
              <label class="skill-name">{{skillName}}</label>
              <input type="number" name="system.skills.tech.{{skillName}}.value" value="{{skill.value}}" min="0" max="10" class="skill-value"/>
              <span class="skill-attribute">({{skill.attribute}})</span>
              <button type="button" class="skill-roll" data-skill="{{skillName}}" data-category="tech">
                <i class="fas fa-dice-d20"></i>
              </button>
            </div>
            {{/each}}
          </div>
        </div>
      </div>

      <!-- Skill Points Display -->
      <div class="skill-points-display">
        <h3>Skill Points Available: {{system.attributes.skillPoints}}</h3>
      </div>
    </div>

    {{!-- Combat Tab --}}
    <div class="tab combat" data-group="primary" data-tab="combat">
      <div class="armor-section">
        <h2>Armor</h2>
        <div class="armor grid grid-4col">
          <div class="armor-location flex-group-center">
            <label>Head</label>
            <input type="text" name="system.armor.head.value" value="{{system.armor.head.value}}" data-dtype="Number"/>
          </div>
          <div class="armor-location flex-group-center">
            <label>Body</label>
            <input type="text" name="system.armor.body.value" value="{{system.armor.body.value}}" data-dtype="Number"/>
          </div>
          <div class="armor-location flex-group-center">
            <label>Arms</label>
            <input type="text" name="system.armor.arms.value" value="{{system.armor.arms.value}}" data-dtype="Number"/>
          </div>
          <div class="armor-location flex-group-center">
            <label>Legs</label>
            <input type="text" name="system.armor.legs.value" value="{{system.armor.legs.value}}" data-dtype="Number"/>
          </div>
        </div>
      </div>

      <div class="weapons-section">
        <h2>Equipped Weapons</h2>
        <div class="weapon-slots grid grid-3col">
          <div class="weapon-slot flex-group-center">
            <label>Primary</label>
            <select name="system.weapons.equipped.primary">
              <option value=""></option>
              {{#each weapons as |weapon id|}}
              <option value="{{weapon._id}}" {{#if (eq ../system.weapons.equipped.primary weapon._id)}}selected{{/if}}>{{weapon.name}}</option>
              {{/each}}
            </select>
          </div>
          <div class="weapon-slot flex-group-center">
            <label>Secondary</label>
            <select name="system.weapons.equipped.secondary">
              <option value=""></option>
              {{#each weapons as |weapon id|}}
              <option value="{{weapon._id}}" {{#if (eq ../system.weapons.equipped.secondary weapon._id)}}selected{{/if}}>{{weapon.name}}</option>
              {{/each}}
            </select>
          </div>
          <div class="weapon-slot flex-group-center">
            <label>Melee</label>
            <select name="system.weapons.equipped.melee">
              <option value=""></option>
              {{#each weapons as |weapon id|}}
              <option value="{{weapon._id}}" {{#if (eq ../system.weapons.equipped.melee weapon._id)}}selected{{/if}}>{{weapon.name}}</option>
              {{/each}}
            </select>
          </div>
        </div>
      </div>

      <div class="status-effects-section">
        <h2>Status Effects</h2>
        <div class="status-effects-list">
          {{#each system.combat.statusEffects as |effect index|}}
          <div class="status-effect-item flexrow">
            <input type="text" name="system.combat.statusEffects.{{index}}.type" value="{{effect.type}}" placeholder="Effect Type"/>
            <input type="number" name="system.combat.statusEffects.{{index}}.duration" value="{{effect.duration}}" placeholder="Duration"/>
            <input type="number" name="system.combat.statusEffects.{{index}}.intensity" value="{{effect.intensity}}" placeholder="Intensity"/>
            <a class="delete-effect" data-index="{{index}}"><i class="fas fa-trash"></i></a>
          </div>
          {{/each}}
          <button type="button" class="add-effect"><i class="fas fa-plus"></i> Add Effect</button>
        </div>
      </div>
    </div>

    {{!-- Inventory Tab --}}
    <div class="tab inventory" data-group="primary" data-tab="inventory">
      <div class="inventory-sections">
        {{!-- Weapons --}}
        <div class="inventory-section">
          <h2>Weapons</h2>
          <ol class="items-list">
            {{#each weapons as |item id|}}
            <li class="item flexrow" data-item-id="{{item._id}}">
              <div class="item-name">{{item.name}}</div>
              <div class="item-damage">{{item.system.damage}}</div>
              <div class="item-range">{{item.system.range}}m</div>
              <div class="item-controls">
                <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
              </div>
            </li>
            {{/each}}
          </ol>
        </div>

        {{!-- Armor --}}
        <div class="inventory-section">
          <h2>Armor</h2>
          <ol class="items-list">
            {{#each armor as |item id|}}
            <li class="item flexrow" data-item-id="{{item._id}}">
              <div class="item-name">{{item.name}}</div>
              <div class="item-armor">{{item.system.armorValue}}</div>
              <div class="item-location">{{item.system.location}}</div>
              <div class="item-controls">
                <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
              </div>
            </li>
            {{/each}}
          </ol>
        </div>

        {{!-- General Items --}}
        <div class="inventory-section">
          <h2>General Items</h2>
          <ol class="items-list">
            {{#each items as |item id|}}
            {{#if (and (ne item.type "weapon") (ne item.type "armor"))}}
            <li class="item flexrow" data-item-id="{{item._id}}">
              <div class="item-name">{{item.name}}</div>
              <div class="item-quantity">{{item.system.quantity}}</div>
              <div class="item-weight">{{item.system.weight}}</div>
              <div class="item-controls">
                <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
              </div>
            </li>
            {{/if}}
            {{/each}}
          </ol>
        </div>
      </div>
    </div>

    {{!-- Background Tab --}}
    <div class="tab background" data-group="primary" data-tab="background">
      <div class="background-section">
        <h2>Background & Perks</h2>
        <div class="form-group">
          <label>Background</label>
          <textarea name="system.background" rows="4">{{system.background}}</textarea>
        </div>

        <div class="perks-section">
          <h3>Perks</h3>
          <ol class="items-list">
            {{#each perks as |item id|}}
            <li class="item flexrow" data-item-id="{{item._id}}">
              <div class="item-name">{{item.name}}</div>
              <div class="item-description">{{item.system.description}}</div>
              <div class="item-controls">
                <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
              </div>
            </li>
            {{/each}}
          </ol>
        </div>

        <div class="quirks-section">
          <h3>Quirks</h3>
          <ol class="items-list">
            {{#each quirks as |item id|}}
            <li class="item flexrow" data-item-id="{{item._id}}">
              <div class="item-name">{{item.name}}</div>
              <div class="item-description">{{item.system.description}}</div>
              <div class="item-controls">
                <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
              </div>
            </li>
            {{/each}}
          </ol>
        </div>
      </div>
    </div>
  </section>
</form>