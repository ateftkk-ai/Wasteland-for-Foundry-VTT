<form class="{{cssClass}} flexcol wastelands-sheet" autocomplete="off">
  {{!-- Header --}}
  <header class="sheet-header">
    <img class="profile-img" src="{{actor.img}}" data-edit="img" title="{{actor.name}}"/>
    <div class="header-fields">
      <h1 class="charname"><input name="name" type="text" value="{{actor.name}}" placeholder="Ranger Name"/></h1>
      <div class="resources grid grid-3col">
        <div class="resource flex-group-center">
          <label for="system.attributes.health.value" class="resource-label">Health</label>
          <div class="resource-content flexrow flex-center flex-between">
            <input type="text" name="system.attributes.health.value" value="{{system.attributes.health.value}}" data-dtype="Number"/>
            <span> / </span>
            <input type="text" name="system.attributes.health.max" value="{{system.attributes.health.max}}" data-dtype="Number"/>
          </div>
        </div>
        
        <div class="resource flex-group-center">
          <label for="system.attributes.actionPoints.value" class="resource-label">Action Points</label>
          <div class="resource-content flexrow flex-center flex-between">
            <input type="text" name="system.attributes.actionPoints.value" value="{{system.attributes.actionPoints.value}}" data-dtype="Number"/>
            <span> / </span>
            <input type="text" name="system.attributes.actionPoints.max" value="{{system.attributes.actionPoints.max}}" data-dtype="Number"/>
          </div>
        </div>
        
        <div class="resource flex-group-center">
          <label for="system.attributes.level" class="resource-label">Level</label>
          <div class="resource-content">
            <input type="text" name="system.attributes.level" value="{{system.attributes.level}}" data-dtype="Number"/>
          </div>
        </div>
      </div>
    </div>
  </header>

  {{!-- Navigation Tabs --}}
  <nav class="sheet-tabs tabs" data-group="primary">
    <a class="item" data-tab="stats">Attributes & Skills</a>
    <a class="item" data-tab="combat">Combat</a>
    <a class="item" data-tab="inventory">Inventory</a>
    <a class="item" data-tab="background">Background</a>
  </nav>

<!-- Enhanced Stats Tab -->
<div class="tab stats" data-group="primary" data-tab="stats">
  
  <!-- Core Attributes -->
  <div class="attributes-section">
    <h2>Core Attributes</h2>
    <div class="attributes grid grid-7col">
      {{#each system.attributes.stats as |stat key|}}
      <div class="attribute flex-group-center">
        <label for="system.attributes.stats.{{key}}.value" class="attribute-label">
          {{key}}
        </label>
        <div class="attribute-value">
          <input type="text" name="system.attributes.stats.{{key}}.value" 
                 value="{{stat.value}}" data-dtype="Number" min="1" max="10"/>
        </div>
        <div class="attribute-modifier">
          {{numberFormat (lookup ../system.attributes.derived (concat key 'Mod')) sign=true}}
        </div>
      </div>
      {{/each}}
    </div>
    
    <!-- Derived Stats -->
    <div class="derived-stats grid grid-3col">
      <div class="derived-stat flex-group-center">
        <label>Strike Rate</label>
        <span>{{system.attributes.derived.strikeRate}}%</span>
      </div>
      <div class="derived-stat flex-group-center">
        <label>Critical Chance</label>
        <span>{{system.attributes.derived.criticalChance}}%</span>
      </div>
      <div class="derived-stat flex-group-center">
        <label>Carry Weight</label>
        <span>{{system.attributes.derived.maxCarryWeight}} kg</span>
      </div>
    </div>
  </div>

  <!-- Skills by Category -->
  <div class="skills-section">
    {{#each system.skills as |category categoryName|}}
    <div class="skill-category">
      <h3>{{categoryName}}</h3>
      <div class="skills-grid grid grid-3col">
        {{#each category as |skill skillName|}}
        <div class="skill-item flexrow flex-between" data-skill="{{skillName}}">
          <div class="skill-info">
            <label class="skill-name">{{skillName}}</label>
            <span class="skill-attribute">({{skill.attribute}})</span>
          </div>
          <div class="skill-controls flexrow">
            <input type="text" name="system.skills.{{categoryName}}.{{skillName}}.value" 
                   value="{{skill.value}}" data-dtype="Number" min="0" max="10"/>
            <button type="button" class="skill-roll" data-skill="{{skillName}}">
              <i class="fas fa-dice-d20"></i>
            </button>
          </div>
        </div>
        {{/each}}
      </div>
    </div>
    {{/each}}
  </div>
</div>
      
      <h3>Skills</h3>
      <div class="skills grid grid-3col">
        {{#each system.skills as |skill key|}}
        <div class="skill flexrow flex-between">
          <label class="skill-label">{{key}}</label>
          <input type="text" name="system.skills.{{key}}.value" value="{{skill.value}}" data-dtype="Number"/>
        </div>
        {{/each}}
      </div>
    </div>

    {{!-- Combat Tab --}}
    <div class="tab combat" data-group="primary" data-tab="combat">
      <div class="armor grid grid-4col">
        <div class="armor-location flex-group-center">
          <label>Head Armor</label>
          <input type="text" name="system.attributes.armor.head" value="{{system.attributes.armor.head}}" data-dtype="Number"/>
        </div>
        <div class="armor-location flex-group-center">
          <label>Body Armor</label>
          <input type="text" name="system.attributes.armor.body" value="{{system.attributes.armor.body}}" data-dtype="Number"/>
        </div>
        <div class="armor-location flex-group-center">
          <label>Arms Armor</label>
          <input type="text" name="system.attributes.armor.arms" value="{{system.attributes.armor.arms}}" data-dtype="Number"/>
        </div>
        <div class="armor-location flex-group-center">
          <label>Legs Armor</label>
          <input type="text" name="system.attributes.armor.legs" value="{{system.attributes.armor.legs}}" data-dtype="Number"/>
        </div>
      </div>
      
      <h3>Weapons</h3>
      <ol class="items-list">
        {{#each weapons as |item id|}}
        <li class="item flexrow" data-item-id="{{item._id}}">
          <div class="item-name">{{item.name}}</div>
          <div class="item-damage">{{item.system.damage}}</div>
          <div class="item-controls">
            <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
            <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
          </div>
        </li>
        {{/each}}
      </ol>
    </div>

    {{!-- Inventory Tab --}}
    <div class="tab inventory" data-group="primary" data-tab="inventory">
      {{!-- Weapons, Armor, Items lists would go here --}}
    </div>
  </section>
</form>