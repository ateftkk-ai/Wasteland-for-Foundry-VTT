<form class="{{cssClass}} flexcol wastelands-sheet robot-sheet" autocomplete="off">
  {{!-- Header --}}
  <header class="sheet-header">
    <img class="profile-img" src="{{actor.img}}" data-edit="img" title="{{actor.name}}"/>
    <div class="header-fields">
      <h1 class="charname"><input name="name" type="text" value="{{actor.name}}" placeholder="Robot Designation"/></h1>
      <div class="resources grid grid-3col">
        <div class="resource flex-group-center">
          <label for="system.attributes.health.value" class="resource-label">Integrity</label>
          <div class="resource-content flexrow flex-center flex-between">
            <input type="text" name="system.attributes.health.value" value="{{system.attributes.health.value}}" data-dtype="Number"/>
            <span> / </span>
            <input type="text" name="system.attributes.health.max" value="{{system.attributes.health.max}}" data-dtype="Number"/>
          </div>
        </div>
        
        <div class="resource flex-group-center">
          <label for="system.attributes.actionPoints.value" class="resource-label">Action Points</label>
          <div class="resource-content flexrow flex-center flex-between">
            <input type="text" name="system.attributes.actionPoints.value" value="{{system.attributes.actionPoints.value}}" data-dtype="Number"/>
            <span> / </span>
            <input type="text" name="system.attributes.actionPoints.max" value="{{system.attributes.actionPoints.max}}" data-dtype="Number"/>
          </div>
        </div>

        <div class="resource flex-group-center">
          <label for="system.attributes.energy.value" class="resource-label">Energy</label>
          <div class="resource-content flexrow flex-center flex-between">
            <input type="text" name="system.attributes.energy.value" value="{{system.attributes.energy.value}}" data-dtype="Number"/>
            <span> / </span>
            <input type="text" name="system.attributes.energy.max" value="{{system.attributes.energy.max}}" data-dtype="Number"/>
          </div>
        </div>
      </div>
    </div>
  </header>

  {{!-- Navigation Tabs --}}
  <nav class="sheet-tabs tabs" data-group="primary">
    <a class="item" data-tab="systems">Systems</a>
    <a class="item" data-tab="combat">Combat</a>
    <a class="item" data-tab="inventory">Inventory</a>
    <a class="item" data-tab="specs">Specifications</a>
  </nav>

  {{!-- Sheet Body --}}
  <section class="sheet-body">
    {{!-- Systems Tab --}}
    <div class="tab systems" data-group="primary" data-tab="systems">
      <div class="robot-details grid grid-2col">
        <div class="left-column">
          <div class="form-group">
            <label for="system.details.model">Model</label>
            <input type="text" name="system.details.model" value="{{system.details.model}}"/>
          </div>
          <div class="form-group">
            <label for="system.details.manufacturer">Manufacturer</label>
            <input type="text" name="system.details.manufacturer" value="{{system.details.manufacturer}}"/>
          </div>
          <div class="form-group">
            <label for="system.attributes.armor.value">Base Armor</label>
            <input type="number" name="system.attributes.armor.value" value="{{system.attributes.armor.value}}" min="0" max="20"/>
          </div>
        </div>
        <div class="right-column">
          <div class="form-group">
            <label>Systems Status</label>
            <div class="systems-status">
              <div class="system-status flexrow">
                <span>Motivator:</span>
                <select name="system.details.systems.motivator">
                  <option value="operational" {{#if (eq system.details.systems.motivator "operational")}}selected{{/if}}>Operational</option>
                  <option value="degraded" {{#if (eq system.details.systems.motivator "degraded")}}selected{{/if}}>Degraded</option>
                  <option value="offline" {{#if (eq system.details.systems.motivator "offline")}}selected{{/if}}>Offline</option>
                </select>
              </div>
              <div class="system-status flexrow">
                <span>Sensors:</span>
                <select name="system.details.systems.sensors">
                  <option value="operational" {{#if (eq system.details.systems.sensors "operational")}}selected{{/if}}>Operational</option>
                  <option value="degraded" {{#if (eq system.details.systems.sensors "degraded")}}selected{{/if}}>Degraded</option>
                  <option value="offline" {{#if (eq system.details.systems.sensors "offline")}}selected{{/if}}>Offline</option>
                </select>
              </div>
              <div class="system-status flexrow">
                <span>Weapons:</span>
                <select name="system.details.systems.weapons">
                  <option value="operational" {{#if (eq system.details.systems.weapons "operational")}}selected{{/if}}>Operational</option>
                  <option value="degraded" {{#if (eq system.details.systems.weapons "degraded")}}selected{{/if}}>Degraded</option>
                  <option value="offline" {{#if (eq system.details.systems.weapons "offline")}}selected{{/if}}>Offline</option>
                </select>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="weakpoints-section">
        <h3>Weak Points</h3>
        <div class="weakpoints-list">
          {{#each system.details.weakpoints as |weakpoint index|}}
          <div class="weakpoint-item flexrow">
            <input type="text" name="system.details.weakpoints.{{index}}.location" value="{{weakpoint.location}}" placeholder="Location"/>
            <input type="text" name="system.details.weakpoints.{{index}}.effect" value="{{weakpoint.effect}}" placeholder="Effect"/>
            <a class="delete-weakpoint" data-index="{{index}}"><i class="fas fa-trash"></i></a>
          </div>
          {{/each}}
          <button type="button" class="add-weakpoint"><i class="fas fa-plus"></i> Add Weak Point</button>
        </div>
      </div>
    </div>

    {{!-- Combat Tab --}}
    <div class="tab combat" data-group="primary" data-tab="combat">
      <div class="weapons-section">
        <h2>Integrated Weapons</h2>
        <div class="weapon-slots grid grid-2col">
          <div class="weapon-slot flex-group-center">
            <label>Primary System</label>
            <select name="system.weapons.equipped.primary">
              <option value=""></option>
              {{#each weapons as |weapon id|}}
              <option value="{{weapon._id}}" {{#if (eq ../system.weapons.equipped.primary weapon._id)}}selected{{/if}}>{{weapon.name}}</option>
              {{/each}}
            </select>
          </div>
          <div class="weapon-slot flex-group-center">
            <label>Secondary System</label>
            <select name="system.weapons.equipped.secondary">
              <option value=""></option>
              {{#each weapons as |weapon id|}}
              <option value="{{weapon._id}}" {{#if (eq ../system.weapons.equipped.secondary weapon._id)}}selected{{/if}}>{{weapon.name}}</option>
              {{/each}}
            </select>
          </div>
        </div>
      </div>

      <div class="status-effects-section">
        <h2>System Mal functions</h2>
        <div class="status-effects-list">
          {{#each system.combat.statusEffects as |effect index|}}
          <div class="status-effect-item flexrow">
            <input type="text" name="system.combat.statusEffects.{{index}}.type" value="{{effect.type}}" placeholder="Malfunction Type"/>
            <input type="number" name="system.combat.statusEffects.{{index}}.duration" value="{{effect.duration}}" placeholder="Duration"/>
            <input type="number" name="system.combat.statusEffects.{{index}}.intensity" value="{{effect.intensity}}" placeholder="Severity"/>
            <a class="delete-effect" data-index="{{index}}"><i class="fas fa-trash"></i></a>
          </div>
          {{/each}}
          <button type="button" class="add-effect"><i class="fas fa-plus"></i> Add Malfunction</button>
        </div>
      </div>
    </div>

    {{!-- Inventory Tab --}}
    <div class="tab inventory" data-group="primary" data-tab="inventory">
      <div class="inventory-sections">
        <div class="inventory-section">
          <h2>Carried Items</h2>
          <ol class="items-list">
            {{#each items as |item id|}}
            <li class="item flexrow" data-item-id="{{item._id}}">
              <div class="item-name">{{item.name}}</div>
              <div class="item-quantity">{{item.system.quantity}}</div>
              <div class="item-weight">{{item.system.weight}}</div>
              <div class="item-controls">
                <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
              </div>
            </li>
            {{/each}}
          </ol>
        </div>
      </div>
    </div>

    {{!-- Specifications Tab --}}
    <div class="tab specs" data-group="primary" data-tab="specs">
      <div class="specs-section">
        <div class="form-group">
          <label>Production Notes</label>
          <textarea name="system.details.biography" rows="6">{{system.details.biography}}</textarea>
        </div>
        <div class="form-group">
          <label>Operational History</label>
          <textarea name="system.details.notes" rows="6">{{system.details.notes}}</textarea>
        </div>
      </div>
    </div>
  </section>
</form>